<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IGPSPORT Map File Name Structure</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #eee;
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #00d9ff, #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 40px;
            font-size: 1.1rem;
        }

        .section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        h2 {
            color: #00d9ff;
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h2::before {
            content: '';
            width: 4px;
            height: 24px;
            background: linear-gradient(180deg, #00d9ff, #00ff88);
            border-radius: 2px;
        }

        /* File Name Structure */
        .filename-structure {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 5px;
            margin: 30px 0;
        }

        .segment {
            text-align: center;
            border-radius: 12px;
            overflow: hidden;
            min-width: 80px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease;
        }

        .segment:hover {
            transform: translateY(-5px);
        }

        .segment-header {
            padding: 12px 20px;
            font-weight: bold;
            font-size: 1.1rem;
            letter-spacing: 1px;
        }

        .segment-body {
            padding: 10px 20px;
            font-size: 0.85rem;
            background: rgba(0, 0, 0, 0.2);
        }

        .seg-country .segment-header { background: #4CAF50; }
        .seg-region .segment-header { background: #2196F3; }
        .seg-date .segment-header { background: #FF9800; }
        .seg-lon-pos .segment-header { background: #F44336; }
        .seg-lat-pos .segment-header { background: #E91E63; }
        .seg-lon-size .segment-header { background: #9C27B0; }
        .seg-lat-size .segment-header { background: #673AB7; }

        /* Example breakdown */
        .example-filename {
            text-align: center;
            font-family: 'Courier New', monospace;
            font-size: 1.8rem;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin: 20px 0;
            letter-spacing: 2px;
        }

        .example-filename span {
            padding: 5px 2px;
            border-radius: 4px;
        }

        .example-filename .cc { background: #4CAF50; }
        .example-filename .rr { background: #2196F3; }
        .example-filename .date { background: #FF9800; color: #000; }
        .example-filename .lon-pos { background: #F44336; }
        .example-filename .lat-pos { background: #E91E63; }
        .example-filename .lon-size { background: #9C27B0; }
        .example-filename .lat-size { background: #673AB7; }

        /* GEO Code detail */
        .geo-structure {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .geo-box {
            border: 3px solid #9C27B0;
            border-radius: 15px;
            padding: 20px;
            background: rgba(156, 39, 176, 0.1);
        }

        .geo-title {
            text-align: center;
            color: #9C27B0;
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .geo-parts {
            display: flex;
            gap: 10px;
        }

        .geo-part {
            text-align: center;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
        }

        .geo-part-label {
            font-size: 0.75rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .geo-part-value {
            font-family: 'Courier New', monospace;
            font-size: 1.3rem;
            font-weight: bold;
        }

        /* Formula cards */
        .formula-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .formula-card {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid;
        }

        .formula-card.lon-pos { border-color: #F44336; }
        .formula-card.lat-pos { border-color: #E91E63; }
        .formula-card.lon-size { border-color: #9C27B0; }
        .formula-card.lat-size { border-color: #673AB7; }

        .formula-card h4 {
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .formula-card.lon-pos h4 { color: #F44336; }
        .formula-card.lat-pos h4 { color: #E91E63; }
        .formula-card.lon-size h4 { color: #9C27B0; }
        .formula-card.lat-size h4 { color: #673AB7; }

        .formula {
            font-family: 'Courier New', monospace;
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 6px;
            font-size: 0.9rem;
            color: #00ff88;
        }

        .formula-desc {
            margin-top: 10px;
            font-size: 0.85rem;
            color: #aaa;
        }

        /* Base36 table */
        .base36-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 5px;
            margin-top: 20px;
        }

        .base36-cell {
            text-align: center;
            padding: 10px 5px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            transition: transform 0.2s ease;
        }

        .base36-cell:hover {
            transform: scale(1.1);
        }

        .base36-char {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .base36-val {
            font-size: 0.7rem;
            opacity: 0.7;
        }

        .base36-digit { background: #263238; }
        .base36-letter { background: #37474F; }

        /* Map visualization */
        .map-visual {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 30px 0;
            gap: 40px;
            flex-wrap: wrap;
        }

        .map-box {
            width: 300px;
            height: 200px;
            border: 3px solid #00d9ff;
            border-radius: 10px;
            position: relative;
            background: linear-gradient(135deg, #1e3a5f 0%, #0d1b2a 100%);
        }

        .map-poland {
            position: absolute;
            top: 20px;
            left: 30px;
            width: 240px;
            height: 140px;
            background: rgba(76, 175, 80, 0.3);
            border: 2px dashed #4CAF50;
            border-radius: 5px;
        }

        .map-label {
            position: absolute;
            font-size: 0.75rem;
            color: #00d9ff;
        }

        .map-label.top { top: 5px; left: 50%; transform: translateX(-50%); }
        .map-label.bottom { bottom: 5px; left: 50%; transform: translateX(-50%); }
        .map-label.left { left: 5px; top: 50%; transform: translateY(-50%) rotate(-90deg); }
        .map-label.right { right: 5px; top: 50%; transform: translateY(-50%) rotate(90deg); }

        .map-info {
            text-align: left;
        }

        .map-info-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }

        .map-info-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        /* Mercator formula highlight */
        .mercator-box {
            background: linear-gradient(135deg, rgba(233, 30, 99, 0.2), rgba(156, 39, 176, 0.2));
            border: 2px solid #E91E63;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }

        .mercator-title {
            color: #E91E63;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .mercator-formula {
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            color: #fff;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px 25px;
            border-radius: 8px;
            display: inline-block;
        }

        /* Footer */
        .footer {
            text-align: center;
            margin-top: 40px;
            color: #666;
            font-size: 0.9rem;
        }

        .footer a {
            color: #00d9ff;
            text-decoration: none;
        }

        @media (max-width: 768px) {
            h1 { font-size: 1.8rem; }
            .filename-structure { flex-direction: column; align-items: center; }
            .segment { width: 100%; max-width: 200px; }
            .geo-parts { flex-wrap: wrap; justify-content: center; }
            .base36-grid { grid-template-columns: repeat(6, 1fr); }
        }

        /* Calculator styles */
        .calculator {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 900px) {
            .calculator { grid-template-columns: 1fr; }
        }

        .calc-panel {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 25px;
        }

        .calc-panel h3 {
            color: #00ff88;
            margin-bottom: 20px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .calc-panel h3 .icon {
            font-size: 1.5rem;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            color: #aaa;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: #00d9ff;
        }

        .input-group input::placeholder {
            color: #555;
        }

        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .calc-btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .calc-btn.encode {
            background: linear-gradient(135deg, #00d9ff, #00ff88);
            color: #000;
        }

        .calc-btn.decode {
            background: linear-gradient(135deg, #E91E63, #9C27B0);
            color: #fff;
        }

        .calc-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 217, 255, 0.3);
        }

        .result-box {
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 255, 136, 0.1);
            border: 2px solid #00ff88;
            border-radius: 10px;
            display: none;
        }

        .result-box.visible {
            display: block;
        }

        .result-box.error {
            background: rgba(244, 67, 54, 0.1);
            border-color: #F44336;
        }

        .result-title {
            color: #00ff88;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .result-box.error .result-title {
            color: #F44336;
        }

        .result-value {
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            word-break: break-all;
        }

        .result-details {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .result-detail-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .result-detail-item:last-child {
            border-bottom: none;
        }

        .detail-label {
            color: #888;
        }

        .detail-value {
            font-family: 'Courier New', monospace;
            color: #00d9ff;
        }

        .arrow-icon {
            font-size: 2rem;
            color: #00d9ff;
            text-align: center;
            padding: 20px 0;
        }

        .generated-filename {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            text-align: center;
        }

        .generated-filename .filename {
            font-family: 'Courier New', monospace;
            font-size: 1.3rem;
            color: #fff;
            letter-spacing: 1px;
        }

        .copy-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .copy-btn.copied {
            background: #4CAF50;
            border-color: #4CAF50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>IGPSPORT Map File Name Structure</h1>

        <!-- Main Structure -->
        <div class="section">
            <h2>File Name Components</h2>

            <div class="filename-structure">
                <div class="segment seg-country">
                    <div class="segment-header">CC</div>
                    <div class="segment-body">Country<br>2 chars</div>
                </div>
                <div class="segment seg-region">
                    <div class="segment-header">RRRR</div>
                    <div class="segment-body">Region<br>4 digits</div>
                </div>
                <div class="segment seg-date">
                    <div class="segment-header">DATE</div>
                    <div class="segment-body">YYMMDD<br>6 digits</div>
                </div>
                <div class="segment seg-lon-pos">
                    <div class="segment-header">LON</div>
                    <div class="segment-body">MIN_LON<br>3 chars</div>
                </div>
                <div class="segment seg-lat-pos">
                    <div class="segment-header">LAT</div>
                    <div class="segment-body">MAX_LAT<br>3 chars</div>
                </div>
                <div class="segment seg-lon-size">
                    <div class="segment-header">LOS</div>
                    <div class="segment-body">LON_SPAN-1<br>3 chars</div>
                </div>
                <div class="segment seg-lat-size">
                    <div class="segment-header">LAS</div>
                    <div class="segment-body">LAT_SPAN-1<br>3 chars</div>
                </div>
            </div>
        </div>

        <!-- Example -->
        <div class="section">
            <h2>Example: Poland Map File</h2>

            <div class="example-filename">
                <span class="cc">PL</span><span class="rr">0000</span><span class="date">250317</span><span class="lon-pos">3EO</span><span class="lat-pos">205</span><span class="lon-size">06D</span><span class="lat-size">060</span><span style="color: #888;">.map</span>
            </div>

            <div class="map-visual">
                <div class="map-box">
                    <span class="map-label top">54.85¬∞ N (latMax)</span>
                    <span class="map-label bottom">49.0¬∞ N</span>
                    <span class="map-label left">14.1¬∞ E (lngMin)</span>
                    <span class="map-label right">24.15¬∞ E</span>
                    <div class="map-poland"></div>
                </div>

                <div class="map-info">
                    <div class="map-info-item">
                        <div class="map-info-color" style="background: #4CAF50;"></div>
                        <div><strong>PL</strong> - Country: Poland</div>
                    </div>
                    <div class="map-info-item">
                        <div class="map-info-color" style="background: #2196F3;"></div>
                        <div><strong>0000</strong> - Whole country</div>
                    </div>
                    <div class="map-info-item">
                        <div class="map-info-color" style="background: #FF9800;"></div>
                        <div><strong>250317</strong> - March 17, 2025</div>
                    </div>
                    <div class="map-info-item">
                        <div class="map-info-color" style="background: #F44336;"></div>
                        <div><strong>3EO</strong> - Tile X: 4416 (~14.1¬∞ E)</div>
                    </div>
                    <div class="map-info-item">
                        <div class="map-info-color" style="background: #E91E63;"></div>
                        <div><strong>205</strong> - Tile Y: 2597 (~54.85¬∞ N)</div>
                    </div>
                    <div class="map-info-item">
                        <div class="map-info-color" style="background: #9C27B0;"></div>
                        <div><strong>06D</strong> - X Span: 230 tiles</div>
                    </div>
                    <div class="map-info-item">
                        <div class="map-info-color" style="background: #673AB7;"></div>
                        <div><strong>060</strong> - Y Span: 217 tiles</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Geographic Code Detail -->
        <div class="section">
            <h2>Geographic Code Structure</h2>

            <div class="geo-structure">
                <div class="geo-box">
                    <div class="geo-title">GEO_CODE (12 characters in Base36) - Tile-based at Zoom 13</div>
                    <div class="geo-parts">
                        <div class="geo-part" style="background: #F44336;">
                            <div class="geo-part-label">Position 1-3</div>
                            <div class="geo-part-value">MIN_LON</div>
                            <div class="geo-part-label" style="margin-top: 5px;">(West)</div>
                        </div>
                        <div class="geo-part" style="background: #E91E63;">
                            <div class="geo-part-label">Position 4-6</div>
                            <div class="geo-part-value">MAX_LAT</div>
                            <div class="geo-part-label" style="margin-top: 5px;">(North)</div>
                        </div>
                        <div class="geo-part" style="background: #9C27B0;">
                            <div class="geo-part-label">Position 7-9</div>
                            <div class="geo-part-value">LON_SPAN-1</div>
                            <div class="geo-part-label" style="margin-top: 5px;">(Width)</div>
                        </div>
                        <div class="geo-part" style="background: #673AB7;">
                            <div class="geo-part-label">Position 10-12</div>
                            <div class="geo-part-value">LAT_SPAN-1</div>
                            <div class="geo-part-label" style="margin-top: 5px;">(Height)</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="formula-grid">
                <div class="formula-card lon-pos">
                    <h4>MIN_LON (Western Border)</h4>
                    <div class="formula">Base36(floor((MIN_LON + 180) / 360 √ó N))</div>
                    <div class="formula-desc">Tile from min longitude (N = 8192)</div>
                </div>
                <div class="formula-card lat-pos">
                    <h4>MAX_LAT (Northern Border)</h4>
                    <div class="formula">Base36(floor(mercatorY(MAX_LAT) √ó N))</div>
                    <div class="formula-desc">Tile from max latitude using Web Mercator (N = 8192)</div>
                </div>
                <div class="formula-card lon-size">
                    <h4>LON_SPAN-1 (Width)</h4>
                    <div class="formula">Base36(LON_END - LON_START)</div>
                    <div class="formula-desc">LON_END = floor((MAX_LON + 180) / 360 √ó N)</div>
                </div>
                <div class="formula-card lat-size">
                    <h4>LAT_SPAN-1 (Height)</h4>
                    <div class="formula">Base36(LAT_END - LAT_START)</div>
                    <div class="formula-desc">LAT_END = floor(mercatorY(MIN_LAT) √ó N)</div>
                </div>
            </div>

            <div class="mercator-box">
                <div class="mercator-title">Web Mercator Tile Projection (Zoom 13, N = 8192)</div>
                <div class="mercator-formula">
                    mercatorY = (1 - ln(tan(lat) + 1/cos(lat)) / œÄ) / 2
                </div>
                <div class="formula-desc" style="margin-top: 10px; color: #aaa;">Note: lat must be in radians (lat_rad = lat_deg √ó œÄ / 180)</div>
            </div>
        </div>

        <!-- Base36 Reference -->
        <div class="section">
            <h2>Base36 Encoding Reference</h2>
            <p style="margin-bottom: 15px; color: #aaa;">Each 3-character group can represent values from 0 to 46,655 (36¬≥ - 1)</p>

            <div class="base36-grid">
                <div class="base36-cell base36-digit"><div class="base36-char">0</div><div class="base36-val">0</div></div>
                <div class="base36-cell base36-digit"><div class="base36-char">1</div><div class="base36-val">1</div></div>
                <div class="base36-cell base36-digit"><div class="base36-char">2</div><div class="base36-val">2</div></div>
                <div class="base36-cell base36-digit"><div class="base36-char">3</div><div class="base36-val">3</div></div>
                <div class="base36-cell base36-digit"><div class="base36-char">4</div><div class="base36-val">4</div></div>
                <div class="base36-cell base36-digit"><div class="base36-char">5</div><div class="base36-val">5</div></div>
                <div class="base36-cell base36-digit"><div class="base36-char">6</div><div class="base36-val">6</div></div>
                <div class="base36-cell base36-digit"><div class="base36-char">7</div><div class="base36-val">7</div></div>
                <div class="base36-cell base36-digit"><div class="base36-char">8</div><div class="base36-val">8</div></div>
                <div class="base36-cell base36-digit"><div class="base36-char">9</div><div class="base36-val">9</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">A</div><div class="base36-val">10</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">B</div><div class="base36-val">11</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">C</div><div class="base36-val">12</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">D</div><div class="base36-val">13</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">E</div><div class="base36-val">14</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">F</div><div class="base36-val">15</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">G</div><div class="base36-val">16</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">H</div><div class="base36-val">17</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">I</div><div class="base36-val">18</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">J</div><div class="base36-val">19</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">K</div><div class="base36-val">20</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">L</div><div class="base36-val">21</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">M</div><div class="base36-val">22</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">N</div><div class="base36-val">23</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">O</div><div class="base36-val">24</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">P</div><div class="base36-val">25</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">Q</div><div class="base36-val">26</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">R</div><div class="base36-val">27</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">S</div><div class="base36-val">28</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">T</div><div class="base36-val">29</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">U</div><div class="base36-val">30</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">V</div><div class="base36-val">31</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">W</div><div class="base36-val">32</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">X</div><div class="base36-val">33</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">Y</div><div class="base36-val">34</div></div>
                <div class="base36-cell base36-letter"><div class="base36-char">Z</div><div class="base36-val">35</div></div>
            </div>
        </div>

        <!-- Calculator Section -->
        <div class="section">
            <h2>Interactive Calculator</h2>

            <div class="calculator">
                <!-- Encode Panel -->
                <div class="calc-panel">
                    <h3><span class="icon">üìç</span> Coordinates ‚Üí Filename</h3>

                    <div class="input-row">
                        <div class="input-group">
                            <label>Country Code (2 chars)</label>
                            <input type="text" id="enc-country" placeholder="PL" maxlength="2" value="PL">
                        </div>
                        <div class="input-group">
                            <label>Region Code (4 digits)</label>
                            <input type="text" id="enc-region" placeholder="0000" maxlength="4" value="0000">
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Date (YYMMDD)</label>
                        <input type="text" id="enc-date" placeholder="250317" maxlength="6">
                    </div>

                    <div class="input-row">
                        <div class="input-group">
                            <label>Min Longitude (West)</label>
                            <input type="number" id="enc-lng-min" placeholder="14.1" step="0.0001" value="14.1">
                        </div>
                        <div class="input-group">
                            <label>Max Longitude (East)</label>
                            <input type="number" id="enc-lng-max" placeholder="24.15" step="0.0001" value="24.15">
                        </div>
                    </div>

                    <div class="input-row">
                        <div class="input-group">
                            <label>Min Latitude (South)</label>
                            <input type="number" id="enc-lat-min" placeholder="49.0" step="0.0001" value="49.0">
                        </div>
                        <div class="input-group">
                            <label>Max Latitude (North)</label>
                            <input type="number" id="enc-lat-max" placeholder="54.85" step="0.0001" value="54.85">
                        </div>
                    </div>

                    <button class="calc-btn encode" onclick="encodeFilename()">Generate Filename</button>

                    <div class="result-box" id="encode-result">
                        <div class="result-title">Generated Filename:</div>
                        <div class="generated-filename">
                            <div class="filename" id="encoded-filename"></div>
                            <button class="copy-btn" onclick="copyFilename()">Copy to Clipboard</button>
                        </div>
                        <div class="result-details">
                            <div class="result-detail-item">
                                <span class="detail-label">GEO Code:</span>
                                <span class="detail-value" id="enc-geo-code"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">X Start (Base36):</span>
                                <span class="detail-value" id="enc-lon-pos"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">Y Start (Base36):</span>
                                <span class="detail-value" id="enc-lat-pos"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">X Span-1 (Base36):</span>
                                <span class="detail-value" id="enc-lon-size"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">Y Span-1 (Base36):</span>
                                <span class="detail-value" id="enc-lat-size"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">Tile Range:</span>
                                <span class="detail-value" id="enc-tile-info"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Decode Panel -->
                <div class="calc-panel">
                    <h3><span class="icon">üîç</span> Filename ‚Üí Coordinates</h3>

                    <div class="input-group">
                        <label>Full Filename or GEO Code (12 chars)</label>
                        <input type="text" id="dec-filename" placeholder="PL00002503173EJ20506N068 or 3EJ20506N068">
                    </div>

                    <button class="calc-btn decode" onclick="decodeFilename()">Decode Coordinates</button>

                    <div class="result-box" id="decode-result">
                        <div class="result-title">Decoded Coordinates:</div>
                        <div class="result-details">
                            <div class="result-detail-item">
                                <span class="detail-label">Country:</span>
                                <span class="detail-value" id="dec-country"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">Region:</span>
                                <span class="detail-value" id="dec-region"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">Date:</span>
                                <span class="detail-value" id="dec-date"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">Min Longitude (West):</span>
                                <span class="detail-value" id="dec-lng-min"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">Max Longitude (East):</span>
                                <span class="detail-value" id="dec-lng-max"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">Min Latitude (South):</span>
                                <span class="detail-value" id="dec-lat-min"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">Max Latitude (North):</span>
                                <span class="detail-value" id="dec-lat-max"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">Width:</span>
                                <span class="detail-value" id="dec-width"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">Height:</span>
                                <span class="detail-value" id="dec-height"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">Tile X Start:</span>
                                <span class="detail-value" id="dec-x-start"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">Tile Y Start:</span>
                                <span class="detail-value" id="dec-y-start"></span>
                            </div>
                            <div class="result-detail-item">
                                <span class="detail-label">Tile Range:</span>
                                <span class="detail-value" id="dec-tile-info"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Constants for tile-based algorithm (Zoom 13)
        const DEFAULT_ZOOM = 13;
        const TILES_PER_SIDE = 1 << DEFAULT_ZOOM; // 8192
        const BASE36_CHARS = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';

        // Validation functions
        function validateCountryCode(code) {
            if (!code || code.length === 0) {
                return { valid: false, error: 'Country code is required' };
            }
            if (code.length !== 2) {
                return { valid: false, error: 'Country code must be exactly 2 characters' };
            }
            if (!/^[A-Za-z]{2}$/.test(code)) {
                return { valid: false, error: 'Country code must contain only letters (A-Z)' };
            }
            return { valid: true };
        }

        function validateRegionCode(code) {
            if (!code || code.length === 0) {
                return { valid: false, error: 'Region code is required' };
            }
            if (code.length !== 4) {
                return { valid: false, error: 'Region code must be exactly 4 digits' };
            }
            if (!/^\d{4}$/.test(code)) {
                return { valid: false, error: 'Region code must contain only digits (0-9)' };
            }
            return { valid: true };
        }

        function validateDate(dateStr) {
            if (!dateStr || dateStr.length === 0) {
                return { valid: false, error: 'Date is required' };
            }
            if (dateStr.length !== 6) {
                return { valid: false, error: 'Date must be exactly 6 digits (YYMMDD)' };
            }
            if (!/^\d{6}$/.test(dateStr)) {
                return { valid: false, error: 'Date must contain only digits' };
            }

            const month = parseInt(dateStr.substring(2, 4), 10);
            const day = parseInt(dateStr.substring(4, 6), 10);

            if (month < 1 || month > 12) {
                return { valid: false, error: 'Month must be between 01 and 12' };
            }
            if (day < 1 || day > 31) {
                return { valid: false, error: 'Day must be between 01 and 31' };
            }
            return { valid: true };
        }

        function validateCoordinates(lngMin, lngMax, latMin, latMax) {
            const errors = [];

            if (isNaN(lngMin)) errors.push('Min Longitude is not a valid number');
            if (isNaN(lngMax)) errors.push('Max Longitude is not a valid number');
            if (isNaN(latMin)) errors.push('Min Latitude is not a valid number');
            if (isNaN(latMax)) errors.push('Max Latitude is not a valid number');

            if (errors.length > 0) {
                return { valid: false, error: errors.join(', ') };
            }

            if (lngMin < -180 || lngMin > 180) {
                errors.push('Min Longitude must be between -180 and 180');
            }
            if (lngMax < -180 || lngMax > 180) {
                errors.push('Max Longitude must be between -180 and 180');
            }
            if (latMin < -85 || latMin > 85) {
                errors.push('Min Latitude must be between -85 and 85 (Mercator limit)');
            }
            if (latMax < -85 || latMax > 85) {
                errors.push('Max Latitude must be between -85 and 85 (Mercator limit)');
            }

            if (errors.length > 0) {
                return { valid: false, error: errors.join(', ') };
            }

            if (lngMin >= lngMax) {
                errors.push('Min Longitude must be less than Max Longitude');
            }
            if (latMin >= latMax) {
                errors.push('Min Latitude must be less than Max Latitude');
            }

            if (errors.length > 0) {
                return { valid: false, error: errors.join(', ') };
            }

            return { valid: true };
        }

        function validateBase36(str) {
            for (const c of str.toUpperCase()) {
                if (BASE36_CHARS.indexOf(c) < 0) {
                    return { valid: false, error: `Invalid Base36 character: '${c}'` };
                }
            }
            return { valid: true };
        }

        function validateFilenameInput(input) {
            if (!input || input.trim().length === 0) {
                return { valid: false, error: 'Please enter a filename or GEO code' };
            }

            const cleaned = input.trim().toUpperCase().replace(/\.MAP$/i, '');

            if (cleaned.length !== 12 && cleaned.length !== 24) {
                return { valid: false, error: `Input must be 12 characters (GEO code) or 24 characters (full filename). You entered ${cleaned.length} characters.` };
            }

            const geoCode = cleaned.length === 12 ? cleaned : cleaned.substring(12, 24);
            const base36Check = validateBase36(geoCode);
            if (!base36Check.valid) {
                return { valid: false, error: `Invalid GEO code: ${base36Check.error}` };
            }

            return { valid: true, cleaned: cleaned, geoCode: geoCode };
        }

        // Base36 encoding
        function toBase36(value, length) {
            if (value < 0) value = 0;
            if (!isFinite(value)) value = 0;
            value = Math.floor(value);
            let result = '';
            for (let i = 0; i < length; i++) {
                result = BASE36_CHARS[value % 36] + result;
                value = Math.floor(value / 36);
            }
            return result;
        }

        // Base36 decoding
        function fromBase36(str) {
            let result = 0;
            for (const c of str.toUpperCase()) {
                const index = BASE36_CHARS.indexOf(c);
                if (index < 0) throw new Error(`Invalid Base36 character: ${c}`);
                result = result * 36 + index;
            }
            return result;
        }

        // Convert longitude to tile X coordinate
        function lonToTileX(lon) {
            return Math.floor((lon + 180.0) / 360.0 * TILES_PER_SIDE);
        }

        // Convert latitude to tile Y coordinate (Web Mercator)
        function latToTileY(lat) {
            const rad = lat * Math.PI / 180.0;
            const y = (1.0 - Math.log(Math.tan(rad) + 1.0 / Math.cos(rad)) / Math.PI) / 2.0 * TILES_PER_SIDE;
            return Math.floor(y);
        }

        // Convert tile X back to longitude
        function tileXToLon(x) {
            return x / TILES_PER_SIDE * 360.0 - 180.0;
        }

        // Convert tile Y back to latitude (inverse Mercator)
        function tileYToLat(y) {
            const n = Math.PI - 2.0 * Math.PI * y / TILES_PER_SIDE;
            return 180.0 / Math.PI * Math.atan(0.5 * (Math.exp(n) - Math.exp(-n)));
        }

        // Encode coordinates to GEO code (tile-based algorithm)
        function encodeGeoCode(lngMin, lngMax, latMin, latMax) {
            // X start - tile from western border
            const xStart = lonToTileX(lngMin);
            // Y start - tile from northern border (WebMercator Y increases southward)
            const yStart = latToTileY(latMax);

            // Tile span
            const xEnd = lonToTileX(lngMax);
            const yEnd = latToTileY(latMin);
            const xSpan = xEnd - xStart + 1;
            const ySpan = yEnd - yStart + 1;

            return {
                geoCode: toBase36(xStart, 3) + toBase36(yStart, 3) + toBase36(xSpan - 1, 3) + toBase36(ySpan - 1, 3),
                lonPos: toBase36(xStart, 3),
                latPos: toBase36(yStart, 3),
                lonSize: toBase36(xSpan - 1, 3),
                latSize: toBase36(ySpan - 1, 3),
                xStart: xStart,
                yStart: yStart,
                xSpan: xSpan,
                ySpan: ySpan
            };
        }

        // Decode GEO code to coordinates (tile-based algorithm)
        function decodeGeoCode(geoCode) {
            if (geoCode.length !== 12) {
                throw new Error('GEO code must be exactly 12 characters');
            }

            const xStart = fromBase36(geoCode.substring(0, 3));
            const yStart = fromBase36(geoCode.substring(3, 6));
            const xSpanMinus1 = fromBase36(geoCode.substring(6, 9));
            const ySpanMinus1 = fromBase36(geoCode.substring(9, 12));

            const xSpan = xSpanMinus1 + 1;
            const ySpan = ySpanMinus1 + 1;

            // Convert tile coordinates back to geographic coordinates
            const lngMin = tileXToLon(xStart);
            const lngMax = tileXToLon(xStart + xSpan);
            const latMax = tileYToLat(yStart);
            const latMin = tileYToLat(yStart + ySpan);

            // Validate results
            if (!isFinite(lngMin) || !isFinite(lngMax) || !isFinite(latMin) || !isFinite(latMax)) {
                throw new Error('Invalid GEO code - calculation resulted in invalid values');
            }

            return {
                lngMin: lngMin,
                lngMax: lngMax,
                latMin: latMin,
                latMax: latMax,
                lngDelta: lngMax - lngMin,
                latDelta: latMax - latMin,
                xStart: xStart,
                yStart: yStart,
                xSpan: xSpan,
                ySpan: ySpan
            };
        }

        // Get today's date in YYMMDD format
        function getTodayDate() {
            const now = new Date();
            const yy = String(now.getFullYear()).slice(-2);
            const mm = String(now.getMonth() + 1).padStart(2, '0');
            const dd = String(now.getDate()).padStart(2, '0');
            return yy + mm + dd;
        }

        // Show error in encode result box
        function showEncodeError(message) {
            const resultBox = document.getElementById('encode-result');
            document.getElementById('encoded-filename').textContent = message;
            document.getElementById('enc-geo-code').textContent = '-';
            document.getElementById('enc-lon-pos').textContent = '-';
            document.getElementById('enc-lat-pos').textContent = '-';
            document.getElementById('enc-lon-size').textContent = '-';
            document.getElementById('enc-lat-size').textContent = '-';
            document.getElementById('enc-tile-info').textContent = '-';
            resultBox.classList.add('visible', 'error');
        }

        // Show error in decode result box
        function showDecodeError(message) {
            const resultBox = document.getElementById('decode-result');
            document.getElementById('dec-country').textContent = message;
            document.getElementById('dec-region').textContent = '-';
            document.getElementById('dec-date').textContent = '-';
            document.getElementById('dec-lng-min').textContent = '-';
            document.getElementById('dec-lng-max').textContent = '-';
            document.getElementById('dec-lat-min').textContent = '-';
            document.getElementById('dec-lat-max').textContent = '-';
            document.getElementById('dec-width').textContent = '-';
            document.getElementById('dec-height').textContent = '-';
            document.getElementById('dec-x-start').textContent = '-';
            document.getElementById('dec-y-start').textContent = '-';
            document.getElementById('dec-tile-info').textContent = '-';
            resultBox.classList.add('visible', 'error');
        }

        // Initialize date field with today
        document.getElementById('enc-date').value = getTodayDate();

        // Encode button handler
        function encodeFilename() {
            const resultBox = document.getElementById('encode-result');
            resultBox.classList.remove('error');

            try {
                const countryRaw = document.getElementById('enc-country').value.trim();
                const regionRaw = document.getElementById('enc-region').value.trim();
                const dateRaw = document.getElementById('enc-date').value.trim();

                // Validate country code
                const countryCheck = validateCountryCode(countryRaw);
                if (!countryCheck.valid) {
                    showEncodeError(countryCheck.error);
                    return;
                }

                // Validate region code
                const regionCheck = validateRegionCode(regionRaw);
                if (!regionCheck.valid) {
                    showEncodeError(regionCheck.error);
                    return;
                }

                // Validate date
                const dateCheck = validateDate(dateRaw);
                if (!dateCheck.valid) {
                    showEncodeError(dateCheck.error);
                    return;
                }

                const country = countryRaw.toUpperCase();
                const region = regionRaw;
                const date = dateRaw;

                const lngMin = parseFloat(document.getElementById('enc-lng-min').value);
                const lngMax = parseFloat(document.getElementById('enc-lng-max').value);
                const latMin = parseFloat(document.getElementById('enc-lat-min').value);
                const latMax = parseFloat(document.getElementById('enc-lat-max').value);

                // Validate coordinates
                const coordCheck = validateCoordinates(lngMin, lngMax, latMin, latMax);
                if (!coordCheck.valid) {
                    showEncodeError(coordCheck.error);
                    return;
                }

                const result = encodeGeoCode(lngMin, lngMax, latMin, latMax);
                const filename = country + region + date + result.geoCode;

                document.getElementById('encoded-filename').textContent = filename + '.map';
                document.getElementById('enc-geo-code').textContent = result.geoCode;
                document.getElementById('enc-lon-pos').textContent = `${result.lonPos} (${result.xStart})`;
                document.getElementById('enc-lat-pos').textContent = `${result.latPos} (${result.yStart})`;
                document.getElementById('enc-lon-size').textContent = `${result.lonSize} (${result.xSpan - 1})`;
                document.getElementById('enc-lat-size').textContent = `${result.latSize} (${result.ySpan - 1})`;
                document.getElementById('enc-tile-info').textContent = `${result.xSpan} x ${result.ySpan} tiles`;

                resultBox.classList.add('visible');
            } catch (error) {
                showEncodeError('Error: ' + error.message);
            }
        }

        // Decode button handler
        function decodeFilename() {
            const resultBox = document.getElementById('decode-result');
            resultBox.classList.remove('error');

            try {
                const inputRaw = document.getElementById('dec-filename').value;

                // Validate input
                const inputCheck = validateFilenameInput(inputRaw);
                if (!inputCheck.valid) {
                    showDecodeError(inputCheck.error);
                    return;
                }

                const input = inputCheck.cleaned;
                let country = '';
                let region = '';
                let date = '';
                let geoCode = inputCheck.geoCode;

                if (input.length === 24) {
                    country = input.substring(0, 2);
                    region = input.substring(2, 6);
                    date = input.substring(6, 12);
                }

                const coords = decodeGeoCode(geoCode);

                document.getElementById('dec-country').textContent = country || 'N/A';
                document.getElementById('dec-region').textContent = region || 'N/A';

                if (date) {
                    const year = '20' + date.substring(0, 2);
                    const month = date.substring(2, 4);
                    const day = date.substring(4, 6);
                    document.getElementById('dec-date').textContent = `${year}-${month}-${day}`;
                } else {
                    document.getElementById('dec-date').textContent = 'N/A';
                }

                document.getElementById('dec-lng-min').textContent = coords.lngMin.toFixed(4) + '¬∞';
                document.getElementById('dec-lng-max').textContent = coords.lngMax.toFixed(4) + '¬∞';
                document.getElementById('dec-lat-min').textContent = coords.latMin.toFixed(4) + '¬∞';
                document.getElementById('dec-lat-max').textContent = coords.latMax.toFixed(4) + '¬∞';
                document.getElementById('dec-width').textContent = coords.lngDelta.toFixed(4) + '¬∞';
                document.getElementById('dec-height').textContent = coords.latDelta.toFixed(4) + '¬∞';
                document.getElementById('dec-x-start').textContent = coords.xStart;
                document.getElementById('dec-y-start').textContent = coords.yStart;
                document.getElementById('dec-tile-info').textContent = `${coords.xSpan} x ${coords.ySpan} tiles`;

                resultBox.classList.add('visible');
            } catch (error) {
                showDecodeError('Error: ' + error.message);
            }
        }

        // Copy filename to clipboard
        function copyFilename() {
            const filename = document.getElementById('encoded-filename').textContent;
            navigator.clipboard.writeText(filename).then(() => {
                const btn = document.querySelector('.copy-btn');
                btn.textContent = 'Copied!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'Copy to Clipboard';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }

        // Allow Enter key to trigger calculation
        document.querySelectorAll('#enc-country, #enc-region, #enc-date, #enc-lng-min, #enc-lng-max, #enc-lat-min, #enc-lat-max').forEach(input => {
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') encodeFilename();
            });
        });

        document.getElementById('dec-filename').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') decodeFilename();
        });
    </script>
</body>
</html>
